<!DOCTYPE html>
<html  lang="en">

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>An introduction to R and Radiant for a first course in Statistics</title>
  <meta name="description" content="Breve manuale per l’apprendimento di alcuni elementi di R e Radiant. Materiale di supporto per il Corso 30001 (Statistica) dell’Università Bocconi.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="An introduction to R and Radiant for a first course in Statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Breve manuale per l’apprendimento di alcuni elementi di R e Radiant. Materiale di supporto per il Corso 30001 (Statistica) dell’Università Bocconi." />
  <meta name="github-repo" content="sergioventurini/manuale_R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="An introduction to R and Radiant for a first course in Statistics" />
  
  <meta name="twitter:description" content="Breve manuale per l’apprendimento di alcuni elementi di R e Radiant. Materiale di supporto per il Corso 30001 (Statistica) dell’Università Bocconi." />
  



<meta name="date" content="2018-07-20">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="chapter5.html">
<link rel="next" href="the-multiple-linear-regression-model.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">An introduction to <tt>R</tt> and <tt>Radiant</tt></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="software-installation.html"><a href="software-installation.html"><i class="fa fa-check"></i><b>1.1</b> Software installation</a><ul>
<li class="chapter" data-level="1.1.1" data-path="software-installation.html"><a href="software-installation.html#installation-under-windows"><i class="fa fa-check"></i><b>1.1.1</b> Installation under Windows</a></li>
<li class="chapter" data-level="1.1.2" data-path="software-installation.html"><a href="software-installation.html#installation-under-mac"><i class="fa fa-check"></i><b>1.1.2</b> Installation under Mac</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="the-r-approach-to-statistics.html"><a href="the-r-approach-to-statistics.html"><i class="fa fa-check"></i><b>1.2</b> The <tt>R</tt> approach to statistics</a></li>
<li class="chapter" data-level="1.3" data-path="main-data-structures-available-in-r.html"><a href="main-data-structures-available-in-r.html"><i class="fa fa-check"></i><b>1.3</b> Main data structures available in <tt>R</tt></a><ul>
<li class="chapter" data-level="1.3.1" data-path="main-data-structures-available-in-r.html"><a href="main-data-structures-available-in-r.html#basic-data-types"><i class="fa fa-check"></i><b>1.3.1</b> Basic data types</a></li>
<li class="chapter" data-level="1.3.2" data-path="main-data-structures-available-in-r.html"><a href="main-data-structures-available-in-r.html#vettori"><i class="fa fa-check"></i><b>1.3.2</b> Vectors</a></li>
<li class="chapter" data-level="1.3.3" data-path="main-data-structures-available-in-r.html"><a href="main-data-structures-available-in-r.html#matrix"><i class="fa fa-check"></i><b>1.3.3</b> Matrices</a></li>
<li class="chapter" data-level="1.3.4" data-path="main-data-structures-available-in-r.html"><a href="main-data-structures-available-in-r.html#factor-vector"><i class="fa fa-check"></i><b>1.3.4</b> Factor vectors</a></li>
<li class="chapter" data-level="1.3.5" data-path="main-data-structures-available-in-r.html"><a href="main-data-structures-available-in-r.html#data-frames"><i class="fa fa-check"></i><b>1.3.5</b> Data frames</a></li>
<li class="chapter" data-level="1.3.6" data-path="main-data-structures-available-in-r.html"><a href="main-data-structures-available-in-r.html#lists"><i class="fa fa-check"></i><b>1.3.6</b> Lists</a></li>
<li class="chapter" data-level="1.3.7" data-path="main-data-structures-available-in-r.html"><a href="main-data-structures-available-in-r.html#funzioni"><i class="fa fa-check"></i><b>1.3.7</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="howtogethelp.html"><a href="howtogethelp.html"><i class="fa fa-check"></i><b>1.4</b> How to get help on <tt>R</tt> commands</a></li>
<li class="chapter" data-level="1.5" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>1.5</b> <tt>R</tt> packages</a></li>
<li class="chapter" data-level="1.6" data-path="the-rstudio-application.html"><a href="the-rstudio-application.html"><i class="fa fa-check"></i><b>1.6</b> The <tt>RStudio</tt> application</a></li>
<li class="chapter" data-level="1.7" data-path="the-radiant-package.html"><a href="the-radiant-package.html"><i class="fa fa-check"></i><b>1.7</b> The <tt>Radiant</tt> package</a></li>
<li class="chapter" data-level="1.8" data-path="file-loading.html"><a href="file-loading.html"><i class="fa fa-check"></i><b>1.8</b> How to load and save a file in <tt>R</tt> and <tt>Radiant</tt></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html"><i class="fa fa-check"></i><b>2</b> Descriptive statistics</a><ul>
<li class="chapter" data-level="2.1" data-path="descriptive-R.html"><a href="descriptive-R.html"><i class="fa fa-check"></i><b>2.1</b> First examples with <tt>R</tt></a></li>
<li class="chapter" data-level="2.2" data-path="univariate-descriptive-analysis.html"><a href="univariate-descriptive-analysis.html"><i class="fa fa-check"></i><b>2.2</b> Univariate descriptive analysis</a><ul>
<li class="chapter" data-level="2.2.1" data-path="univariate-descriptive-analysis.html"><a href="univariate-descriptive-analysis.html#a-single-categorical-variable"><i class="fa fa-check"></i><b>2.2.1</b> A single categorical variable</a></li>
<li class="chapter" data-level="2.2.2" data-path="univariate-descriptive-analysis.html"><a href="univariate-descriptive-analysis.html#a-single-numerical-variable"><i class="fa fa-check"></i><b>2.2.2</b> A single numerical variable</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="bivariate-descriptive-analyses.html"><a href="bivariate-descriptive-analyses.html"><i class="fa fa-check"></i><b>2.3</b> Bivariate descriptive analyses</a><ul>
<li class="chapter" data-level="2.3.1" data-path="bivariate-descriptive-analyses.html"><a href="bivariate-descriptive-analyses.html#two-categorical-variables"><i class="fa fa-check"></i><b>2.3.1</b> Two categorical variables</a></li>
<li class="chapter" data-level="2.3.2" data-path="bivariate-descriptive-analyses.html"><a href="bivariate-descriptive-analyses.html#lincorr"><i class="fa fa-check"></i><b>2.3.2</b> Two numerical variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>3</b> Probability</a><ul>
<li class="chapter" data-level="3.1" data-path="binomial-random-variables.html"><a href="binomial-random-variables.html"><i class="fa fa-check"></i><b>3.1</b> Binomial random variables</a></li>
<li class="chapter" data-level="3.2" data-path="normal-or-gaussian-random-variables.html"><a href="normal-or-gaussian-random-variables.html"><i class="fa fa-check"></i><b>3.2</b> Normal (or Gaussian) random variables</a></li>
<li class="chapter" data-level="3.3" data-path="other-random-variables.html"><a href="other-random-variables.html"><i class="fa fa-check"></i><b>3.3</b> Other random variables</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="inferential-statistics.html"><a href="inferential-statistics.html"><i class="fa fa-check"></i><b>4</b> Inferential statistics</a><ul>
<li class="chapter" data-level="4.1" data-path="inference-on-the-mean-of-a-normal-population.html"><a href="inference-on-the-mean-of-a-normal-population.html"><i class="fa fa-check"></i><b>4.1</b> Inference on the mean of a normal population</a></li>
<li class="chapter" data-level="4.2" data-path="inference-on-the-proportion-of-successes-in-a-bernoulli-population.html"><a href="inference-on-the-proportion-of-successes-in-a-bernoulli-population.html"><i class="fa fa-check"></i><b>4.2</b> Inference on the proportion of successes in a Bernoulli population</a></li>
<li class="chapter" data-level="4.3" data-path="inference-on-the-comparison-between-the-means-of-two-normal-populations.html"><a href="inference-on-the-comparison-between-the-means-of-two-normal-populations.html"><i class="fa fa-check"></i><b>4.3</b> Inference on the comparison between the means of two normal populations</a><ul>
<li class="chapter" data-level="4.3.1" data-path="inference-on-the-comparison-between-the-means-of-two-normal-populations.html"><a href="inference-on-the-comparison-between-the-means-of-two-normal-populations.html#independent-samples"><i class="fa fa-check"></i><b>4.3.1</b> Independent samples</a></li>
<li class="chapter" data-level="4.3.2" data-path="inference-on-the-comparison-between-the-means-of-two-normal-populations.html"><a href="inference-on-the-comparison-between-the-means-of-two-normal-populations.html#paired-ttest"><i class="fa fa-check"></i><b>4.3.2</b> Dependent samples</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="inference-on-the-linear-correlation-index.html"><a href="inference-on-the-linear-correlation-index.html"><i class="fa fa-check"></i><b>4.4</b> Inference on the linear correlation index</a></li>
<li class="chapter" data-level="4.5" data-path="goodness-of-fit-test-fully-specified-probabilities.html"><a href="goodness-of-fit-test-fully-specified-probabilities.html"><i class="fa fa-check"></i><b>4.5</b> Goodness-of-fit test (fully specified probabilities)</a></li>
<li class="chapter" data-level="4.6" data-path="independence-test-in-a-two-way-table.html"><a href="independence-test-in-a-two-way-table.html"><i class="fa fa-check"></i><b>4.6</b> Independence test in a two-way table</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter5.html"><a href="chapter5.html"><i class="fa fa-check"></i><b>5</b> The linear regression model</a><ul>
<li class="chapter" data-level="5.1" data-path="simple-reg.html"><a href="simple-reg.html"><i class="fa fa-check"></i><b>5.1</b> The simple linear regression model</a></li>
<li class="chapter" data-level="5.2" data-path="the-multiple-linear-regression-model.html"><a href="the-multiple-linear-regression-model.html"><i class="fa fa-check"></i><b>5.2</b> The multiple linear regression model</a></li>
<li class="chapter" data-level="5.3" data-path="how-to-compute-the-predictions-of-a-linear-regression-model.html"><a href="how-to-compute-the-predictions-of-a-linear-regression-model.html"><i class="fa fa-check"></i><b>5.3</b> How to compute the predictions of a linear regression model</a></li>
<li class="chapter" data-level="5.4" data-path="influential-observations.html"><a href="influential-observations.html"><i class="fa fa-check"></i><b>5.4</b> Influential observations</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>6</b> Appendix</a><ul>
<li class="chapter" data-level="6.1" data-path="some-r-functions-for-descriptive-statistics.html"><a href="some-r-functions-for-descriptive-statistics.html"><i class="fa fa-check"></i><b>6.1</b> Some <tt>R</tt> functions for descriptive statistics</a><ul>
<li class="chapter" data-level="6.1.1" data-path="some-r-functions-for-descriptive-statistics.html"><a href="some-r-functions-for-descriptive-statistics.html#univariate-descriptive-analyses"><i class="fa fa-check"></i><b>6.1.1</b> Univariate descriptive analyses</a></li>
<li class="chapter" data-level="6.1.2" data-path="some-r-functions-for-descriptive-statistics.html"><a href="some-r-functions-for-descriptive-statistics.html#bivariate-descriptive-analyses-1"><i class="fa fa-check"></i><b>6.1.2</b> Bivariate descriptive analyses</a></li>
<li class="chapter" data-level="6.1.3" data-path="some-r-functions-for-descriptive-statistics.html"><a href="some-r-functions-for-descriptive-statistics.html#further-graphical-representations"><i class="fa fa-check"></i><b>6.1.3</b> Further graphical representations</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="some-r-functions-for-inferential-statistics.html"><a href="some-r-functions-for-inferential-statistics.html"><i class="fa fa-check"></i><b>6.2</b> Some <tt>R</tt> functions for inferential statistics</a><ul>
<li class="chapter" data-level="6.2.1" data-path="some-r-functions-for-inferential-statistics.html"><a href="some-r-functions-for-inferential-statistics.html#inference-on-the-mean-of-a-normal-population-1"><i class="fa fa-check"></i><b>6.2.1</b> Inference on the mean of a normal population</a></li>
<li class="chapter" data-level="6.2.2" data-path="some-r-functions-for-inferential-statistics.html"><a href="some-r-functions-for-inferential-statistics.html#inference-on-the-proportion-of-successes-in-a-bernoulli-population-1"><i class="fa fa-check"></i><b>6.2.2</b> Inference on the proportion of successes in a Bernoulli population</a></li>
<li class="chapter" data-level="6.2.3" data-path="some-r-functions-for-inferential-statistics.html"><a href="some-r-functions-for-inferential-statistics.html#inference-on-the-comparison-between-the-means-of-two-normal-populations-1"><i class="fa fa-check"></i><b>6.2.3</b> Inference on the comparison between the means of two normal populations</a></li>
<li class="chapter" data-level="6.2.4" data-path="some-r-functions-for-inferential-statistics.html"><a href="some-r-functions-for-inferential-statistics.html#inference-on-the-linear-correlation-index-1"><i class="fa fa-check"></i><b>6.2.4</b> Inference on the linear correlation index</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><strong>An introduction to <tt>R</tt> and <tt>Radiant</tt> for a first course in Statistics</strong></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simple-reg" class="section level2">
<h2><span class="header-section-number">5.1</span> The simple linear regression model</h2>
<p>As we discussed in the course, the simple linear regression model is defined by</p>
<span class="math display" id="eq:linreg-simple">\[\begin{equation}
Y_i = \beta_0 + \beta_1 x_i + \varepsilon_i, \quad i=1,\ldots,n,
\tag{5.1}
\end{equation}\]</span>
<p>where <span class="math inline">\((x_i, y_i)\)</span> represent the pairs of sample observations, <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are the unknown coefficients that are supposed to link the <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> variables in the population, while <span class="math inline">\(\varepsilon_i\)</span> corresponds to the random error which intuitively describes the information about <span class="math inline">\(Y\)</span> that cannot be explained through a linear function of <span class="math inline">\(X\)</span>. In addition to equation <a href="simple-reg.html#eq:linreg-simple">(5.1)</a>, the simple linear regression model is also defined by the following assumptions:</p>
<ol style="list-style-type: decimal">
<li>the <span class="math inline">\(x_i\)</span> values are fixed numbers, or they are realizations of a random variable <span class="math inline">\(X\)</span> that is independent of the errors terms, <span class="math inline">\(\varepsilon_i\)</span>. In the latter case inference is carried out conditionally on the observed values of <span class="math inline">\(X\)</span></li>
<li>the error terms, <span class="math inline">\(\varepsilon_i\)</span>, are random variables with mean 0 and variance <span class="math inline">\(\sigma^2\)</span> which is constant for every <span class="math inline">\(i=1,\ldots,n\)</span> (homoskedasticity)</li>
<li>the random error terms, <span class="math inline">\(\varepsilon_i\)</span>, are uncorrelated with each other</li>
<li>the random errors, <span class="math inline">\(\varepsilon_i\)</span>, are normally distributed</li>
</ol>
<p>The main function for estimating a linear regression model in <tt>R</tt> is <tt>lm()</tt>, which stands for <em>linear model</em>. The first argument of this function is a type of object we never encountered so far called a <em>formula</em>. Formula objects are used in <tt>R</tt> to specify a relationship between a dependent variable <tt>y</tt> and one (or more) independent variables <tt>x</tt>. To specify a formula object it is necessary to use a special symbol, the tilde “<tt><span class="math inline">\(\sim\)</span></tt>”, which is not always easy to retrieve on the Italian keyboards<a href="#fn41" class="footnoteRef" id="fnref41"><sup>41</sup></a>. The particular combination of keys that you need to use to get this symbol depends on the operating system (Mac, Windows, etc.), the type of machine you are using (laptops, desktops, etc.), as well as the particular brand of your machine. For this reason, it is not possible to indicate here unequivocally how to obtain the tilde on your particular computer, but we suggest an unpretentious but very simple way to get it: execute the code <tt>?tilde</tt>, copy the tilde character in the help page and paste it where you need it<a href="#fn42" class="footnoteRef" id="fnref42"><sup>42</sup></a>.</p>
<p>The general syntax of the <tt>lm()</tt> function is</p>
<center>
<tt>lm(y ~ x)</tt>,
</center>
<p>which returns a list (see Section <a href="main-data-structures-available-in-r.html#lists">1.3.6</a>) containing a large number of results related to the estimated model. As an example, let’s consider the data frame <tt>comp</tt> available in the <tt>competitors.RData</tt> file. The data frame <tt>comp</tt> contains the values measured in 113 consecutive weeks for the following variables related to a company that produces a food product:</p>
<ul>
<li><tt>mktshare</tt> indicates the market share (in relative terms) of the company at the end of each week</li>
<li><tt>ownprice</tt> indicates the price (in $) of the product offered by the company in question at the end of each week</li>
<li><tt>comp1price</tt> indicates the price (in $) of the same product offered by a company competitor at the end of each week</li>
<li><tt>comp2price</tt> indicates the price (in $) of the same product offered by a second company competitor at the end of each week</li>
</ul>
<p>We want to estimate the linear relationship between the company’s market share in the various weeks and the price of its product in the same weeks, that is, we are interested in estimating the model</p>
<span class="math display" id="eq:linreg-simple-comp">\[\begin{equation}
\mbox{mktshare}_i = \beta_0 + \beta_1 \mbox{ownprice}_i + \varepsilon_i.
\tag{5.2}
\end{equation}\]</span>
<p>After loading the data (see Section <a href="file-loading.html#file-loading">1.8</a>), you can use the <tt>View()</tt> function to have a look at them. The following code uses the <tt>lm()</tt> function to estimate the model. The results are stored in the <tt>comp_m1</tt> object, which can be summarized using the <tt>summary()</tt> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">load</span>(<span class="st">&quot;competitors.RData&quot;</span>)
<span class="op">&gt;</span><span class="st"> </span>comp_m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(mktshare <span class="op">~</span><span class="st"> </span>ownprice, <span class="dt">data =</span> comp)
<span class="op">&gt;</span><span class="st"> </span><span class="kw">summary</span>(comp_m1)</code></pre></div>
<pre><code>
Call:
lm(formula = mktshare ~ ownprice, data = comp)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.017151 -0.009612 -0.003100  0.006425  0.050105 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.110433   0.014983   7.371 3.24e-11 ***
ownprice    -0.045318   0.008956  -5.060 1.67e-06 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.01293 on 111 degrees of freedom
Multiple R-squared:  0.1874,    Adjusted R-squared:  0.1801 
F-statistic:  25.6 on 1 and 111 DF,  p-value: 1.674e-06</code></pre>
<p>Please note that in addition to the formula argument <tt>mktshare <span class="math inline">\(\sim\)</span> ownprice</tt>, which specifies the model to be estimated, we also added a second argument in the <tt>lm()</tt> function called <tt>data</tt>. This argument is used to provide <tt>R</tt> with the data frame where the variables specified in the formula are found<a href="#fn43" class="footnoteRef" id="fnref43"><sup>43</sup></a>.</p>
<p>The <tt>summary()</tt> function applied to the list returned by the <tt>lm()</tt> produces an output consisting of the following parts:</p>
<ul>
<li>the first line of the output (<tt>Call</tt>) reports the code that has been executed</li>
<li>the second part of the output (<tt>Residuals</tt>) provides a summary of the model’s residuals</li>
<li>the third part (<tt>Coefficients</tt>) provides the estimates of the model’s coefficients and the corresponding p-values. For the previous example, the estimated model is given by</li>
</ul>
<span class="math display" id="eq:linreg-simple-comp-fit">\[\begin{equation}
\widehat{\mbox{mktshare}}_i = 0.1104 -0.0453 \, \mbox{ownprice}_i.
\tag{5.3}
\end{equation}\]</span>
<ul>
<li>the fourth and last part (last three lines) contain some useful indices to evaluate the overall goodness of the model, in particular the estimate of <span class="math inline">\(\sigma\)</span> (referred to as <tt>residual standard error</tt>), the <span class="math inline">\(R^2\)</span> index (reported as <tt>Multiple R-squared</tt>), and the <span class="math inline">\(F\)</span> test (last line of the output)</li>
</ul>
<p>The <span class="math inline">\(R^2\)</span> index (<tt>0.1874</tt>) indicates a limited predictive ability of the model, even if the low p-value of the coefficient <span class="math inline">\(\beta_1\)</span> (<tt>1.67e-06</tt>) suggests that the linear association between the two variables is significant from a statistical point of view.</p>
<p>It is possible to display the fitted line directly on the scatter plot of the two variables using the following code<a href="#fn44" class="footnoteRef" id="fnref44"><sup>44</sup></a>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(mktshare <span class="op">~</span><span class="st"> </span>ownprice, <span class="dt">data =</span> comp)
<span class="op">&gt;</span><span class="st"> </span><span class="kw">abline</span>(comp_m1, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:lm-fitted-line"></span>
<img src="R_manual_files/figure-html/lm-fitted-line-1.pdf" alt="Scatter plot of &lt;tt&gt;mktshare&lt;/tt&gt; versus &lt;tt&gt;ownprice&lt;/tt&gt; with its corresponding estimated line." width="480" />
<p class="caption">
Figure 5.1: Scatter plot of <tt>mktshare</tt> versus <tt>ownprice</tt> with its corresponding estimated line.
</p>
</div>
<p>The first line of code uses the <tt>plot()</tt> function, but unlike what we have seen previously, in this case we have indicated the variables to be represented in the graph through a formula. The second line of code uses the <tt>abline()</tt> function, which adds a line to the active chart, in this case the estimated line.</p>
<p>The output provided by <tt>R</tt> for a linear regression model includes the p-values for the tests on the two coefficients, but does not include the corresponding confidence intervals. To get these, you need to use the <tt>confint()</tt> function directly on the result of <tt>lm()</tt>. For the previous example we have:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">confint</span>(comp_m1)</code></pre></div>
<pre><code>                  2.5 %      97.5 %
(Intercept)  0.08074335  0.14012364
ownprice    -0.06306539 -0.02757108</code></pre>
<p>Other useful functions to inspect the results of a linear regression model (not necessarily a simple one) are:</p>
<ul>
<li><tt>coef()</tt>, which prints the coefficient estimates</li>
<li><tt>residuals()</tt>, which calculates the model residuals</li>
<li><tt>fitted()</tt>, which calculates the predicted values of the model only for the observations included in the sample</li>
<li><tt>anova()</tt>, which produces the deviance decomposition</li>
<li><tt>predict()</tt>, which allows us to calculate predictions</li>
</ul>
<p>Leaving aside for the moment <tt>predict()</tt>, to which we dedicate a subsequent section of the chapter, we now see the type of output produced by the other functions mentioned above:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">coef</span>(comp_m1)</code></pre></div>
<pre><code>(Intercept)    ownprice 
 0.11043350 -0.04531824 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">anova</span>(comp_m1)</code></pre></div>
<pre><code>Analysis of Variance Table

Response: mktshare
           Df    Sum Sq   Mean Sq F value    Pr(&gt;F)    
ownprice    1 0.0042783 0.0042783  25.604 1.674e-06 ***
Residuals 111 0.0185475 0.0001671                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The following code saves in two vectors the predicted values for the observations in the sample and the corresponding residuals, which we remind are defined as the differences between the observed and those predicted by the model. These quantities can be represented in a graph, known as the residual graph, which represents a fundamental tool for assessing the goodness of the model (i.e. the assumptions regarding errors):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>comp_m1_fitted &lt;-<span class="st"> </span><span class="kw">fitted</span>(comp_m1)
<span class="op">&gt;</span><span class="st"> </span>comp_m1_resid &lt;-<span class="st"> </span><span class="kw">residuals</span>(comp_m1)
<span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(comp_m1_fitted, comp_m1_resid, <span class="dt">xlab =</span> <span class="st">&quot;Fitted values&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Residuals&quot;</span>)
<span class="op">&gt;</span><span class="st"> </span><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:lm-res-fit"></span>
<img src="R_manual_files/figure-html/lm-res-fit-1.pdf" alt="Plot of residuals versus predicted values for model &lt;tt&gt;comp_m1&lt;/tt&gt;." width="480" />
<p class="caption">
Figure 5.2: Plot of residuals versus predicted values for model <tt>comp_m1</tt>.
</p>
</div>
<p>The <tt>h</tt> and <tt>lty</tt> options in the previous code allow us to draw an horizontal line (in correspondence of the value 0 on the vertical axis) and to choose the line type (the value 2 indicates a dotted line) respectively.</p>
</div>
<div class="footnotes">
<hr />
<ol start="41">
<li id="fn41"><p>We use the tilde symbol because <tt>R</tt> is a software born and developed in the Anglo-Saxon countries and on the US and UK keyboards this symbol is directly available as one of the keys.<a href="simple-reg.html#fnref41">↩</a></p></li>
<li id="fn42"><p>In general, on Mac computers you should be able to retrieve the tilde symbol with the combination of keys alt+5, i.e. the option key, usually located on the left of the space bar, along with the number 5. On most desktop computers (but not laptops) with a Windows operating system, it is possible to retrieve the tilde with the key combination Alt+126, i.e. the Alt key (usually located on the left of the space bar) together with the number 126. The number 126 must be entered using the numeric keypad (i.e. do not use the numbers placed above the central part of the keyboard). Unfortunately, the position of this symbol on laptops depends on the keyboard and the brand of the laptop itself, so we invite you to consult the instruction manual of your laptop.<a href="simple-reg.html#fnref42">↩</a></p></li>
<li id="fn43"><p>This is necessary because the variables of a given frame are not available as self-contained objects in <tt>R</tt> memory, unless you previously <tt>attach()</tt>-ed the data frame.<a href="simple-reg.html#fnref43">↩</a></p></li>
<li id="fn44"><p>The <tt>lwd</tt> option allows to choose the thickness of the line, while <tt>col</tt> allows to choose its color.<a href="simple-reg.html#fnref44">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter5.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="the-multiple-linear-regression-model.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
